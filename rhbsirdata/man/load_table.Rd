% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/load_table.R
\name{load_table}
\alias{load_table}
\title{Load HBSIR Data with Local Caching}
\source{
The data is sourced from the Iran Open Data initiative, hosted on
ArvanCloud S3 storage.
}
\usage{
load_table(table_name, year, as_data_frame = TRUE, force_download = FALSE)
}
\arguments{
\item{table_name}{Character string. The name of the HBSIR data table to load
(e.g., "food", "urban_expenditures").}

\item{year}{Numeric or character string. The year for which the data is
required (e.g., 1400, 1401).}

\item{as_data_frame}{Logical. If \code{TRUE} (the default), the function returns a
standard R \code{data.frame}. If \code{FALSE}, it returns a more memory-efficient
\code{arrow::Table} object.}

\item{force_download}{Logical. If \code{TRUE}, the function will download the data
from S3 even if a cached version exists locally. Defaults to \code{FALSE}.}
}
\value{
If \code{as_data_frame} is \code{TRUE}, a \code{data.frame}.
If \code{as_data_frame} is \code{FALSE}, an \code{arrow::Table} object.
Stops with an error if the data cannot be downloaded or read.
}
\description{
Downloads a specified HBSIR (Household Budget Survey Iran) data table
for a given year from a public S3 repository. The function implements
local caching to avoid re-downloading data on subsequent requests.
}
\details{
The S3 URL structure is assumed to be=
\verb{https://s3.ir-tbz-sh1.arvanstorage.ir/iran-open-data/HBSIR/4_cleaned/YEAR_TABLENAME.parquet}
For example, for \code{table_name = "food"} and \code{year = 1400}, it would attempt to
download from \verb{.../4_cleaned/1400_food.parquet}.
}
\examples{
\dontrun{
  # Load the 'food' table for the year 1400 as a data.frame
  food_data_1400 <- load_table(table_name = "food", year = 1400)
  head(food_data_1400)

  # Load the 'income' table for year 1399 as an Arrow Table
  income_arrow_1399 <- load_table(table_name = "income", year = 1399, as_data_frame = FALSE)
  print(income_arrow_1399)

  # Force a re-download of the 'food' table for year 1400
  food_data_1400_fresh <- load_table(table_name = "food", year = 1400, force_download = TRUE)
}
}
